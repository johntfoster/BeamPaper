\documentclass[11pt]{amsart}
\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   % ... or a4paper or a5paper or ... 
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{color}
\usepackage{epsfig}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage{etoolbox}
\usepackage{tikz}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{xfrac}
\usepackage{import}
\usepackage[section]{placeins}

\usepackage{cleveref}
%\usepackage{autonum}


%\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\graphicspath{{../}}
\graphicspath{{./images/}}
\newcommand{\diagrampath}{./diagrams/}
\newcommand{\plotpath}{./plots}

\newcommand{\mathbi}[1]{\mathit{\mathbf{#1}}}

\newcommand\vstate[3]{%
	\mathbf{\underline{#1}}%
	\ifstrempty{#2}{}{[#2]}%
	\ifstrempty{#3}{}{\langle #3 \rangle}}
\newcommand\sstate[3]{%
	\mathit{\underline{#1}}%
	\ifstrempty{#2}{}{[#2]}%
	\ifstrempty{#3}{}{\langle #3 \rangle}%
	}


\title{Peridynamic Beams: \\ A Non-ordinary, State Based Model}
\author{James O'Grady \and John T. Foster}
%\date{}                                           % Activate to display a given date or no date

\begin{document}

\begin{abstract}
This paper develops a new peridynamic state based model to represent the bending of an Euler-Bernoulli beam.
This model is non-ordinary and derived from the concept of a rotational spring between bonds.
While multiple peridynamic material models capture the behavior of solid materials, this is the first 1D state based peridynamic model to resist bending.
For sufficiently homogenous and differentiable displacements, the model is shown to be equivalent to Eringen's nonlocal elasticity.
As the peridynamic horizon approaches 0, it reduces to the classical Euler-Bernoulli beam equations.
Simple test cases demonstrate the model's performance.
\end{abstract}

\maketitle

\section{Introduction}
A goal of many mechanical engineering analyses is the prediction and description of material failure.
When processes such as fracture are modeled, the partial-differential equations of classical mechanics are ill-defined at the resulting discontinuities in displacement.  A peridynamic formulation of continuum mechanics casts material behavior in terms of integral functions of displacement (as opposed to gradients of displacement), so that discontinuities evolve naturally and require no special treatment.  Various peridynamic material models capture the material behavior of 3-dimensional solid objects \cite{silling2007peridynamic, silling2005meshfree, gerstle2007peridynamic}, but would be very expensive to implement for a thin plate or beam, as the thru-thickness discretization requirement to properly capture resistance to bending would cause an inordinate amount of computational nodes along the length in a long, slender structural object.  Other peridynamic models capture tension and compression in 1D bars and 2D plates, but these models do not resist transverse displacement {\color{red} [Ref]}.  A recent paper by Taylor and Steigmann \cite{taylor2013two} reduces a bond based 3D plate to two dimensions with an integral through the plate's thickness, to create a model that can represent thin structures, but fails to properly {\color{red} XXX}.

This paper presents a peridynamic equivalent to an Euler-Bernoulli beam, along with a methodology for representing non-uniform cross-sections, plastic behavior, and failure.  In addition to directly modeling a thin beam in bending, the simple beam case lays the theoretical framework for more complex peridynamic beam, plate, and shell bending models.
Because many analyses of interest are partly or wholly comprised of these types of features, their development is an important addition to the capabilities of peridynamic analysis.
%
%The second section of this paper provides a brief introduction to peridynamics, including state based models.
%The third section presents the state based beam model and demonstrates equivalence to classical Euler-Bernoulli beam theory in the limit of vanishing nonlocality.
%The fourth section demonstrates the model's equivalence to Eringen's nonlocal elasticity for small peridynamic horizons, and compares other gradient models.
%The fifth section demonstrates the beam model with simple test cases.
The remainder of this introduction reviews other nonlocal work and provides a brief introduction to peridynamics, including state based models.
\Cref{sec:ModelDev} presents the state based beam model and demonstrates equivalence to classical Euler-Bernoulli beam theory in the limit of shrinking nonlocality.
\Cref{sec:EringenCompare} demonstrates the model's equivalence to Eringen's nonlocal elasticity for small peridynamic horizons.
\Cref{sec:Numerical} demonstrates the beam model with simple test cases.
%
\subsection{Nonlocal Beam Models}
\label{sec:NLbeams}
%
Nonlocal elasticity generally allows for forces at a point that are dependent on the material configuration of an entire body, rather than the configuration at that point \cite{eringen1972nonlocal}.  While long-range forces are obvious at the molecular model, material at larger scales is conventionally modeled as though internal forces are local or contact forces \cite{kroner1967elasticity}.
The result of such approximation is accurate for deformations that are homogenous, but introduces some inaccuracy for inhomogenous deformations like the propagation of waves with short wavelengths.
One way to distinguish between homogenous and inhomogenous deformations is to incorporate higher-order gradients of deformation.
While stress in classical elasticity is a function of the (first) gradient of deformation, Eringen's formulation of a nonlocal modulus in \cite{eringen1983differential} approximates a weighted sum of the first and second order gradients.
This introduces a length scale to the model and has the effect of smearing out local deformation inhomogeneities over the surrounding material, while maintaining the conventional result for homogenous deformations.

Previous work in the nonlocal mechanics of beams is motivated by the observed stiffening of nanoscale cantilevers.
Challamel and Wang demonstrate in \cite{Challamel2008small} that Eringen nonlocal elasticity cannot reproduce the scale stiffening, but that stiffening does result from other gradient-elastic models and models incorporating nonlocal curvature.
Because all of these models incorporate higher-order gradients of deformation, they impose stronger continuity requirements than classical elasticity, and are unsuitable for discontinuous displacements.
Because the gradients are evaluated locally, gradient models are called \textit{weakly nonlocal}.

%
\subsection{Peridynamics}
\label{sec:PDintro}
The term \textit{peridynamic} was coined by Silling in \cite{silling2000reformulation} and alludes to the fact that the force at a point is affected by nearby material configuration.
In contrast to gradient models, the peridynamic model is \textit{strongly nonlocal} and casts material behavior at a point as the \textit{integral} equation 
%
\begin{equation}
\label{eq:PDCoPV}
\rho(\mathbf{x})\ddot{\mathbf{u}}(\mathbf{x}) = \int_\Omega \mathbi{f}(\mathbf{x},\mathbf{q}) dV_\mathbf{q}  + \mathbf{b}(\mathbf{x}) \notag
\end{equation}
%
rather than the classical \textit{differential} equation.
Instead of the divergence of stress, we have the integral of a ``force" function $\mathbi{f}$ of the position vector $\mathbf{x}$ and the position vector $\mathbf{q}$ of a point within the body domain $\Omega$. 
This force function may depend on \(\mathbf{x}\), \(\mathbf{q}\), their deformed positions, the original and deformed positions of other points in \(\Omega\), history, etc.

Constitutive modeling of a wide variety of materials is accomplished by choosing the appropriate form for the force function.
While the simplest force functions recreate a one-parameter linear elastic solid material\cite{silling2000reformulation}, other force functions can be used to model nonlinear elasticity, plasticity, damage, and other behaviors\cite{silling2005peridynamic}.
To describe force functions that incorporate the behavior of all points in the nearby material (not just \(\mathbf{x}\) and \(\mathbf{q}\)), we must introduce the concept of a peridynamic state.

Introduced by Silling et al.\ in 2007~\cite{silling2007peridynamic}, states are functions of the behavior of the continuum points surrounding each location.
The most common states are scalar states and vector states which are scalar and vector valued, respectively.
Unlike multiplication by a second order tensor, which can only map vectors linearly to other vectors, vector states can produce highly nonlinear or even discontinuous mappings.
Important properties of states are magnitude and direction, while important operations include the addition and decomposition of states, inner and tensor products, and the Fr\'{e}chet derivative of a function with respect to a state~\cite{silling2007peridynamic}.

Conservation of linear momentum in the \textit{state based} peridynamic formulation results in the equation of motion,
%
\begin{equation}
\label{eq:PDstateEoM}
\rho(\mathbf{x})\ddot{\mathbf{u}}(\mathbf{x}) = \int_\Omega (\vstate{T}{\mathbf{x}}{\mathbf{q}-\mathbf{x}}-\vstate{T}{\mathbf{q}}{\mathbf{x}-\mathbf{q}}) dV_\mathbf{q}  + \mathbf{b}(\mathbf{x}),\notag
\end{equation}
%
in which $\vstate{T}{\;}{\;}$ is a \textit{force vector-state} that maps the vector in angle brackets, $\langle \rangle$, originating at the point in square brackets, [ ], to a force vector acting on that point.
The deformed image of the vector $\mathbf{q}-\mathbf{x}$ is defined as the \textit{deformation vector-state}, usually denoted $\vstate{Y}{}{}$ and formulated as shown in \cref{eq:PDdeformation}. 
%
\begin{equation}
\label{eq:PDdeformation}
\vstate{Y}{\mathbf{x}}{\mathbf{q}-\mathbf{x}} = (\mathbf{q}-\mathbf{x}) + (\mathbf{u}(\mathbf{q})-\mathbf{u}(\mathbf{x}))
\end{equation}
%

Just as stress and strain are work conjugate, so too are the force and deformation vector states for hyperelastic materials.
If the force state $\vstate{T}{}{}$ is always in the same direction as the deformation state $\vstate{Y}{}{}$, then the force exerted by a ``bond'' between points is in the same direction as the deformed bond, and the model is called \textit{ordinary}.  
Models in which they are not in the same direction are called \textit{non-ordinary}.
Silling et al.\ demonstrate the possibility of such models in \cite{silling2010peridynamic}, but very little work has touched on their use.
Foster et al.\ \cite{foster2010viscoplasticity} and Warren et al.\ \cite{warren2009non} show that correspondence models, which approximate the deformation gradient and use it to calculate bond forces, result in non-ordinary state based constitutive models for deformation with large rotation.
%
\FloatBarrier
%
\section{Model Development}
\label{sec:ModelDev}
Consider the material model illustrated in \cref{fig:SimpleBondpair} in which every bond vector emanating from a point is connected by a rotational spring to its opposite emanating from that same point.
%
\begin{figure}[h]
\subinputfrom{\diagrampath}{simpleBondPair.eps_tex}
\caption{Illustration of a bond pair model that resists angular deformation}
\label{fig:SimpleBondpair}
\end{figure}
%
If we call the deformed angle between these bonds \(\theta\), and choose the potential energy of that spring to be \( w = \alpha [1 + \cos(\theta) ] \), we can recover the non-ordinary force state proposed by Silling in \cite{silling2007peridynamic}.
%
\begin{equation}
\label{eq:SillingForceNO}
\vstate{T}{}{\boldsymbol{\xi}} =\frac{-\alpha}{|\vstate{Y}{}{\boldsymbol{\xi}}|} \frac{\vstate{Y}{}{\boldsymbol{\xi}}}{|\vstate{Y}{}{\boldsymbol{\xi}}|} \times \left[\frac{\vstate{Y}{}{\boldsymbol{\xi}}}{|\vstate{Y}{}{\boldsymbol{\xi}}|} \times \frac{\vstate{Y}{}{-\boldsymbol{\xi}}}{|\vstate{Y}{}{-\boldsymbol{\xi}}|}\right]
\end{equation}
%
Though it looks complex, \cref{eq:SillingForceNO} indicates a bond force perpendicular to the deformed bond and in the plane containing both the deformed bond and its partner as illustrated in \cref{fig:Bondpair}. 
The force magnitude is proportional to the sine of the angle between the bonds divided by the length of the deformed bond. 
%
\begin{figure}[h]
\subinputfrom{\diagrampath}{bondPair.eps_tex}
\caption{Deformation and force vector states}
\label{fig:Bondpair}
\end{figure}
%
This response is consistent with the idea of a rotational spring between bonds as long as the change in angle is small. 
Because the potential energy and force states are functions of \textit{pairs} of peridynamic bonds, we will call this formulation a \textit{bond-pair model}. 
Other choices for the bond-pair potential function, such as \( w = (\pi - \theta)^2 \), are also possible, but result in more mathematically complex analysis.
\subsection{Energy Equivalence}
\label{sec:EnergyEq}
%
To determine an appropriate choice of $\alpha$, we desire our peridynamic model to have an equivalent strain energy density to a classical Euler-Bernoulli beam in the \emph{local limit}, i.e.\ when the nonlocal length scale vanishes.  We will begin with the assumptions from Euler beam theory: the length of the beam is much greater than thickness, vertical displacements are small, and rotations are small. For small vertical displacments we have
%
\begin{equation}
\theta(\vstate{Y}{}{\xi},\vstate{Y}{}{\mathbf{-\xi}}) \approx \pi-\frac{v(x+\xi)-2v(x)+v(x-\xi)}{\xi},
\label{eq:beamdtheta}
\end{equation}
%
where $v$ is the vertical displacement of material point.  Using a Taylor series to expand the right-hand-side of eq.~(\ref{eq:beamdtheta})  
%
\begin{equation}
\theta(\vstate{Y}{}{\xi},\vstate{Y}{}{\mathbf{-\xi}}) \approx \pi-\xi \frac{\partial^2 v}{\partial x^2}+\mathcal{O}(\xi^3) =  \pi-\xi \kappa +\mathcal{O}(\xi^3); 
\label{eq:beamdtheta2}
\end{equation}
with
\begin{equation}
\kappa = \frac{\partial^2 v}{\partial x^2}.\notag
\end{equation}
%
Substituting eq.~(\ref{eq:beamdtheta2}) into the equation for the strain energy density of a single bond-pair,
%
\begin{align}
\label{eq:continuousBeamw}
w = \omega(\xi) \alpha \left[1+\cos(\theta(\vstate{Y}{}{\xi},\vstate{Y}{}{\mathbf{-\xi}})) \right] = \omega(\xi) \alpha\frac{\xi^2}{2}(\kappa)^2 +\mathcal{O}(\xi^4).\notag
\end{align}
%
If we use a weighting function \(\omega(\xi)=\omega(|\xi|)\) and assume that the $\omega$ plays the role of a localization kernel, i.e. $\omega = 0 \, \forall \, \xi > \delta$, the resulting strain energy density, $W$, for any material point in the peridynamic beam is
%
\begin{equation}
W = \frac{\alpha}{2}\kappa^2 \int_{-\delta}^\delta \omega(\xi)\xi^2 {\rm d}\xi + \mathcal{O}(\delta^5).\notag
\end{equation}
%
Equating $W$ with the classical Euler-Bernoulli beam strain-energy density, $\Omega$, and taking the limit as $\delta \to 0$ we can solve for $\alpha$
%
\begin{align}
    \lim_{\delta \to 0}  W &= \Omega, \notag \\
    \frac{\alpha}{2} m \kappa^2 &= \frac{EI}{2} \kappa^2, \notag \\
    \alpha &= \frac{EI}{m},
\label{eq:alpha}
\end{align}
%
with 
\begin{equation}
    m = \int_{-\delta}^{\delta} \omega(\xi) \xi^2 {\rm d}\xi \notag.
\end{equation}


\subsection{Weighting Function and Perfect Plasticity}
\label{sec:WeightFunction}
The weighting function \(\omega(\xi)\) describes the relative contribution of each bond-pair, and can be defined according to physical or mathematical considerations. 
Consider a classical Euler-Bernoulli beam in bending with curvature \(\kappa\). 
Fibers running parallel to the neutral axis of the beam are stretched in proportion to their distance from the neutral axis, with strain \(\epsilon = y\kappa\). 
If the fibers are linearly elastic, then the axial stress at each location is \(\sigma = E\epsilon = Ey\kappa\), and the contribution to supported moment \(dM = \kappa E y^2 dA\). 
By comparing the formulations for the moments carried by the Euler beam in \cref{fig:EulerBending} and those of the bond-pair beam in \cref{fig:BPBending}, we see some definite parallels.
%
\begin{figure}[h]
\subinputfrom{\diagrampath}{EulerBending.eps_tex}
\caption{Euler beam moment contribution}
\label{fig:EulerBending}
\end{figure}
%%
\begin{figure}[h]
\subinputfrom{\diagrampath}{BondPairBending_edit.eps_tex}
\caption{Bond-pair moment contribution}
\label{fig:BPBending}
\end{figure}
%
\begin{align}
M_\text{classical}&=\int_{-\frac{t}{2}}^{\frac{t}{2}} \sigma \; y \; dA && = \int_{-\frac{t}{2}}^{\frac{t}{2}} E \kappa \; y^2 \; b(y) dy\notag \\
%
M_\text{PD}&=\int_{-\delta}^{\delta} \vstate{T}{}{\xi}\; \xi \; d\xi & = \int_{-\delta}^{\delta} \alpha \frac{\sin(\Delta\theta)}{|\xi|} \; \xi \; \omega(\xi) d\xi\: & \approx \int_{-\delta}^{\delta} \alpha \kappa |\xi| \; \omega(\xi) d\xi\notag
\end{align}
%
The term \(y\) is the distance from the beam's neutral axis and \(b(y)\) is the width of the beam at that distance from the neutral axis. 
The similarity between classical and peridynamic moment formulations suggests a possible formulation for the weighting function:
%
\begin{equation}
\omega(\xi) = |\xi| b\left(y\right) \text{at}\; y=\frac{\xi}{\delta} \frac{t}{2}\notag
\end{equation}
%
\begin{figure}[h]
\minipage[t]{0.5\textwidth}
 \centering
  \subinputfrom{\diagrampath}{WeightProfile_Uniform.eps_tex}
\caption{Weight function for a beam of rectangular cross-section}
\label{fig:WeightProfileUniform}
\endminipage\hfill
\minipage[t]{0.5\textwidth}%
  \centering
  \subinputfrom{\diagrampath}{WeightProfile_Ibeam.eps_tex}
\caption{Weight function for an I-beam}
\label{fig:WeightProfileIbeam}
\endminipage
\end{figure}
%
This weight function analogizes the relative contributions of bond pairs of different lengths to the relative contributions of fibers at different distances from the centerline. 
Examples are shown in \cref{fig:WeightProfileUniform,fig:WeightProfileIbeam}.
    While this weighting function offers no advantages over a uniform weight function in the case of the linearly elastic beam, it offers a way to model advancing plasticity.

In a bent Elastic Perfectly Plastic beam, axial fibers are still stretched in proportion to their distance from the neutral axis, but the relationship \(\sigma = E\epsilon = Ey\kappa\) only holds for \(|\epsilon| = |y\kappa| < \epsilon_c\). 
For greater stretches, the relationship becomes \(\sigma = \pm E\epsilon_c \). 
To model this behavior, consider a bond pair with similar behavior: for angular deformation less than some critical angle, the model behaves as previously described, but the magnitude of the force remains constant above a critical deformation
%
\[ 
|\vstate{T}{}{\xi}| = 
  \begin{cases}
    \alpha \frac{\sin(\theta(\vstate{Y}{}{\xi},\vstate{Y}{}{\mathbf{-\xi}}))}{|\vstate{Y}{}{\xi}|} & \quad \text{if } \theta < \theta_c\\
    \alpha \frac{\sin(\theta_c)}{|\vstate{Y}{}{\xi}|} & \quad \text{if } \theta \geq \theta_c\
  \end{cases}
\]
%
to determine the critical angle \(\theta_c\), we let the onset of plasticity in pairs of the longest bonds to coincide with the onset of plasticity in the fibers at the top and bottom surfaces of the classical beam. 
For small curvatures \(\Delta\theta = \xi\kappa\implies\Delta\theta_c = \frac{2\delta\epsilon_c}{t}\). 
For curvatures \(|\kappa| > \kappa_c=\frac{2\epsilon_c}{t}\), the radius within which bonds are in the elastic region is \(\delta_e = \delta \frac{\kappa_c}{\kappa}\), and parallels the distance from the beam centerline that fibers are in the elastic region \(y_e = \frac{t}{2} \frac{\kappa_c}{\kappa}\)
%
\begin{align}
  M_\text{classical} &= 2 \int_{0}^{y_e}E b(y)y^2 \kappa dy +2 \int_{y_e}^{\frac{t}{2}}E b(y) \epsilon_c y dy\notag \\
  M_\text{PD} &= 2 \int_{0}^{\delta_e}\alpha \omega(\xi) \xi^2 \kappa d\xi +2 \int_{\delta_e}^{\delta}\alpha \omega(\xi) \Delta\theta_c \xi d\xi \notag
\end{align}
%
Of course, as long as the force is independent of history, this model only represents a nonlinear elastic material. 
By keeping track of the plastic deformation \(\theta^p (\xi) = \theta-\theta_c\) of each bond-pair, and applying it as an offset, we can reproduce the hysteresis associated with elastic-perfectly-plastic deformation.
%
%
\section{Relation to Eringen Nonlocality}
\label{sec:EringenCompare}
%If we relax our homogeneity assumption somewhat, we recover from \cref{eq:beamdtheta} slightly more complex expressions for change in angle
If we keep an additional term from the Taylor series approximation of \cref{eq:beamdtheta}, we recover a slightly more complex expressions for change in angle
%
\begin{equation}
\label{eq:beamdthetaHOT}
%\theta(\vstate{Y}{}{\xi},\vstate{Y}{}{\mathbf{-\xi}}) \approx \pi-\xi \frac{\partial^2 y}{\partial x^2} -\frac{\xi^3}{12} \frac{\partial^4 y}{\partial x^4}  +\mathcal{O}(\xi^5)=  \pi-\xi \kappa-\frac{\xi^3}{12} \kappa''+\mathcal{O}(\xi^5)\notag
\theta(\vstate{Y}{}{\xi},\vstate{Y}{}{\mathbf{-\xi}}) \approx \arctan\left(\pi-\xi \frac{\partial^2 v}{\partial x^2} -\frac{\xi^3}{12} \frac{\partial^4 v}{\partial x^4}  +\mathcal{O}(\xi^5)\right)\notag
\end{equation}
%
and for the strain energy (again substituting \(\kappa = v''\) for readability),
%
%\begin{equation}
%W \approx \int_{-\delta}^\delta \omega(\xi)\alpha(\frac{\xi^2}{2}\kappa^2+\frac{\xi^4}{12}\kappa\kappa''-\frac{3\; \xi^4}{8}\kappa^4+\mathcal{O}(\xi^6)) d\xi .
%\end{equation}
%
%
\begin{equation}
%W \approx \int_{-\delta}^\delta \omega(\xi)\alpha(\frac{\xi^2}{2}\kappa^2+\frac{\xi^4}{12}\kappa\kappa''-\frac{\xi^4}{24}\kappa^4+\mathcal{O}(\xi^6)) d\xi .\notag
W \approx \int_{-\delta}^\delta \omega(\xi)\alpha(\frac{\xi^2}{2}\kappa^2+\frac{\xi^4}{12}\kappa\kappa''-\frac{3\; \xi^4}{8}\kappa^4+\mathcal{O}(\xi^6)) d\xi.\notag
\end{equation}
%
As the horizon \(\delta\) becomes small, higher-order \(\xi\) terms become relatively less important, and \(\xi^4\kappa^4\) is dominated by \(\xi^2\kappa^2\) for large \(\kappa\) and by \(\xi^4\kappa\kappa''\) for small \(\kappa\).
We can picture a bending resistance based on the bond length and the nonlocal curvature  \(\bar{\kappa}\), so that 
%
\begin{align}
\alpha\bar{\kappa}&= \alpha(\kappa + \frac{\xi^2}{6}\kappa'') \implies \notag \\
W &\approx \int_{-\delta}^\delta \omega(\xi)\alpha \frac{\xi^2}{2}\kappa\bar{\kappa}d\xi.\notag
\end{align}
%  
The same analysis can be taken further to obtain higher-order energy terms with even powers of \(\xi\) and even order derivatives of \(\kappa\). 
Not all of these higher-order terms can be separated into the product of a local curvature and nonlocal bending resistance.

Eringen's model for nonlocal elasticity in \cite{eringen1983differential} begins with a nonlocal modulus (denoted here as \(K(|\mathbf{x}'-\mathbf{x}|,\tau)\)) that relates the nonlocal stress \(\mathbf{t}\) at a point to the classical (local) stress \(\boldsymbol{\sigma}\) in the nearby material through the integral
\begin{equation}
\mathbf{t} = \int_\mathbf{V} K(|\mathbf{x}'-\mathbf{x}|,\tau)\sigma(\mathbf{x}')dv(\mathbf{x}').\notag
\end{equation}
In the local limit these relationships take the form of higher-order gradients.
Using a 1-dimensional decaying exponential nonlocal modulus \(K(|x|,\tau)=\frac{1}{l\tau}e^{-\frac{|x|}{l\tau}}\)results in a relationship between \(t\) and \(\sigma\) 
\begin{align}
\left(1-\tau^2l^2\frac{\partial^2}{\partial x^2}\right)t&=\sigma,\notag
\end{align}
in which \(\tau^2l^2\) is a scale-based material parameter.
For well-behaved \(t\) and \(\sigma\) and small values of \(\sigma''''\) and \(\tau^2l^2\), we can see that this relationship could be reformulated as
\begin{equation}
\label{eq:NLstress}
t=\left(1+\tau^2l^2\frac{\partial^2}{\partial x^2}\right)\sigma.\notag
\end{equation}
If we consider the results of the previous section and let \(dM = y\sigma dA\) and \(\sigma = Ey\kappa\), the contribution to moment resulting from Eringen's nonlocal elasticity in a fiber at \(y\)
\begin{equation}
\label{eq:EringenMoment}
E y^2 (\kappa+\tau^2l^2\kappa''), \\
\end{equation}
and the resulting strain energy
\begin{equation}
\label{eq:EringenEnergy}
\int_{-\frac{t}{2}}^{\frac{t}{2}} b(y) E \frac{y^2}{2} \kappa (\kappa+\tau^2l^2\kappa'')  dy,\notag
\end{equation}
bear a striking resemblance to \cref{eq:NLbending}.

%This is consistent with Eringen's observation of nonlocal modulus as Green's function of a linear differential operator in~\cite{eringen1983differential}. 
The similarity between \cref{eq:NLbending,eq:EringenMoment} is not accidental; Eringen's gradient elasticity is the solution to the integral formulation of the nonlocal stress integral equation just as the peridynamic energy is an integral function of nonlocal displacements.
It is therefore unsurprising that, like Eringen's nonlocal elasticity, the peridynamic bending model fails to predict the stiffening associated with nanoscale cantilevers.
Instead, the advantage of peridynamic models is their natural handling of discontinuities.

\section{Numerical Simulation}
\label{sec:Numerical}
\subsection{Discretized Model}
\label{sec:Discretized}
For analysis purposes, it is often useful to represent a continuum part with a discrete version. 
Discretizing the bond-pair model is primarily matter of exchanging integrals for sums. 
%
\begin{align}
%\label{eq:discreteBeamw}
w = \alpha \left[1+\cos(\theta(\vstate{Y}{}{\xi},\vstate{Y}{}{\mathbf{-\xi}})) \right] \approx \frac{\alpha}{2}\left(\frac{v(x+\xi)-2v(x)+v(x-\xi)}{\xi}\right)^2 \notag
\end{align}
%
\begin{align}
\label{eq:discretebeam}
\alpha &= \frac{c\; \Delta x}{m} ;\; c= EI ;\; m=\sum_{i=1}^n \omega(\xi_i)\xi_i^2 \implies \nonumber \\
W&=\Delta x \sum_{i=1}^n \frac{EI}{2}\left(\frac{v(x+\xi_i)-2v(x)+v(x-\xi_i)}{\xi_i}\right)^2\notag
\end{align}
%
Discretization of the original model results in the equation of motion
\begin{equation}
\rho(\mathbf{x})\mathbf{\ddot{u}}(\mathbf{x}) = \mathbf{f}(\mathbf{x})+\sum_i \omega(\xi_i)\left\{\frac{\alpha(\mathbf{x})}{|\mathbf{p}_i |}\frac{\mathbf{p}_i}{|\mathbf{p}_i |}\times\left[\frac{\mathbf{p}_i}{|\mathbf{p}_i |}\times \frac{\mathbf{q}_i}{|\mathbf{q}_i |}\right]-\frac{\alpha(\mathbf{x}+\boldsymbol{\xi}_i)}{|\mathbf{p}_i |}\frac{(-\mathbf{p}_i)}{|\mathbf{p}_i |}\times\left[\frac{(-\mathbf{p}_i)}{|\mathbf{p}_i |}\times \frac{\mathbf{r}_i}{|\mathbf{r}_i |}\right]\right\}\notag
\end{equation}
with
\begin{align}
\mathbf{p}_i &= \boldsymbol{\xi}_i+\mathbf{u}(\mathbf{x}+\boldsymbol{\xi}_i)-\mathbf{u}(\mathbf{x});\notag\\
\mathbf{q}_i &= -\boldsymbol{\xi}_i+\mathbf{u}(\mathbf{x}-\boldsymbol{\xi}_i)-\mathbf{u}(\mathbf{x});\notag\\
\mathbf{r}_i &= \boldsymbol{\xi}_i+\mathbf{u}(\mathbf{x}+2\boldsymbol{\xi}_i)-\mathbf{u}(\mathbf{x}+\boldsymbol{\xi}_i).\notag
\end{align}
and for small displacements and rotations in a uniform beam,
\begin{equation}
\rho(x)\ddot{v}(x) = f(x)+\alpha \sum_i 2\omega(\xi_i)\frac{v(x-2\xi_i)-4v(x-\xi_i)+6v(x)-4v(x+\xi_i)+v(x+2\xi_i)}{\xi_i^2}\notag
\end{equation}
Discretizing the bond-pair model as proposed above requires that nodes be evenly spaced along the entire beam, otherwise the displacement \(v(x-\xi_i)\) is ill-defined. 
For this reason, the discretization does not allow for areas of higher and lower ``resolution''. 
%
\subsection{Numerical Method}
\label{sec:NumMethod}
Model behavior was evaluated by implementing the discretized equation of motion.
The case of a beam simply supported at both ends was chosen for simplicity in both evaluation and comparison.
Boundary conditions such as clamped supports and applied moments require careful treatment to ensure both meaningful results and ease of computation.

Deformations for quasistatic loading were computed by implicitly solving the zero-acceleration discrete equation of motion with a Newton's Method solver.
%
\subsection{Results}
\label{sec:Results}
The simplest test case for this model is a linear-elastic beam with a square profile.
The models below were constrained to purely vertical movement of each point in order to reduce the total number of degrees of freedom, speeding evaluation and improving convergence.
For comparison, equivalent models are created and analyzed in Abaqus 6.12 to verify simple cases.
Even a coarse discretization successfully reproduces the elastically deformed beam shape in \cref{fig:elastic_g2000}.

\begin{figure}[h]
  \centering
  \scalebox{.6}{\input{\plotpath/elastic_h20_g2000.pgf}}
  \caption{The uniform-load elastic beam is accurately modeled with few nodes}
  \label{fig:elastic_g2000}
\end{figure}

As an elastic-perfectly-plastic beam exceeds the elastic limit of its material, plastic zones begin to grow on the top and bottom of the beam's cross section.
This behavior is mimicked by the plasticity of the longest bond-pairs, producing the results shown in \cref{fig:eppu_h10_g2000}.
To accurately capture this phenomenon and model beam plasticity, a finer discretization is required.
\begin{figure}[h]
  \centering
  \scalebox{.6}{\input{\plotpath/eppu_h10_g2000.pgf}}
  \caption{The elastic perfectly-plastic beam requires finer discretization}
  \label{fig:eppu_h10_g2000}
\end{figure}

A material that is plastically deformed does not return to its original state when unloaded.
For a beam in bending, the residual deformations can be seen in a beam that has been loaded beyond the onset of plastic deformation and then unloaded.
This result is observed in the bond-pair plasticity model, shown in \cref{fig:ResidualPlasticityN,fig:ResidualPlasticityH}. 
Accurate residual deformation modeling requires both a relatively small horizon and a fairly large number of nodes.

%
\begin{figure}[h]
  \centering
  \scalebox{.6}{\input{\plotpath/unloaded2_h10_g2000_n.pgf}}
  \caption{The need for fine discretization is even more apparent when representing residual plastic deformation}
  \label{fig:ResidualPlasticityN}
\end{figure}
%
\begin{figure}[h]
  \centering
  \scalebox{.6}{\input{\plotpath/unloaded2_n1000_g2000_h.pgf}}
  \caption{Accurately modeling residual plastic deformation also requires a small horizon}
  \label{fig:ResidualPlasticityH}
\end{figure}
%
%\begin{figure}[h]
%\minipage[t]{0.5\textwidth}
% \centering
%  \scalebox{.45}{\input{\plotpath/unloaded2_h10_g2000_n.pgf}}
%\caption{N-convergence}
%\label{fig:ResidualPlasticityN}
%\endminipage\hfill
%\minipage[t]{0.5\textwidth}%
%  \centering
%  \scalebox{.45}{\input{\plotpath/unloaded2_n1000_g2000_h.pgf}}
%\caption{H-convergence}
%\label{fig:ResidualPlasticityH}
%\endminipage
%\end{figure}

It is more difficult to verify the brittle material model because brittle failure is unstable.
When a crack begins, moment is transferred to other bond pairs, and failure progresses until every pair of bonds surrounding a node are broken, creating a hinge at that node.
This is borne out by the results in \cref{fig:brittleBeam}, in which ``Nodal Health'' represents the fraction of bond-pairs about each node that have not failed.

\begin{figure}[h]
  \centering
  \scalebox{.65}{\input{\plotpath/brittle_h10_n200.pgf}}
  \caption{A brittle beam with prescribed center displacement}
  \label{fig:brittleBeam}
\end{figure}

Unlike a local model, partial failure is observed at nodes near the plastic hinge, as pairs of bonds that straddle the hinge are broken.

\section{Conclusion}
\label{sec:Conclusion}

As far as we know, this the first peridynamic state based thin feature model, and results in accurate deformation results for simple beam tests.
The proposed damage model successfully reproduces the impact of nonlinear elasticity on deformation of a rectangular cantilever, and the framework is laid to allow application of the same model to I-beams.
It simplifies treatment of bending in beams, and is extensible to bending in plates.


\bibliographystyle{plain}
\bibliography{jogrady_bibdesk}

\end{document} 
\end
